<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>토토디자인 미팅 상담 시트</title>
    <!-- 외부 라이브러리 로드 -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', 'Apple SD Gothic Neo', 'Noto Sans KR', 'Malgun Gothic', sans-serif;
            background-color: #f8fafc;
        }
        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        @media print {
            .no-print { display: none !important; }
            body { background-color: white; padding: 0; }
            .print-padding { padding: 0 !important; }
            section, .section-break {
                page-break-inside: avoid;
                break-inside: avoid;
            }
            .max-w-6xl > * {
                page-break-inside: avoid;
                break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Lucide 아이콘을 React에서 안전하게 사용하기 위한 컴포넌트
        // Lucide의 직접적인 DOM 조작과 React의 Virtual DOM 충돌을 방지하기 위해 dangerouslySetInnerHTML 사용
        const Icon = ({ name, size = 20, className = "" }) => {
            const [svgContent, setSvgContent] = useState('');

            useEffect(() => {
                const generateIcon = () => {
                    if (window.lucide && window.lucide.icons && window.lucide.icons[name]) {
                        const svg = window.lucide.icons[name].toSvg({
                            width: size,
                            height: size,
                            class: className,
                            'stroke-width': 2
                        });
                        setSvgContent(svg);
                    }
                };

                generateIcon();
                if (!svgContent && window.lucide) {
                    const timer = setTimeout(generateIcon, 100);
                    return () => clearTimeout(timer);
                }
            }, [name, size, className, !!window.lucide]);

            if (!svgContent) return <span style={{ width: size, height: size, display: 'inline-block' }}></span>;

            return (
                <span 
                    style={{ width: size, height: size, display: 'inline-flex', alignItems: 'center', justifyContent: 'center' }}
                    dangerouslySetInnerHTML={{ __html: svgContent }} 
                />
            );
        };

        const SPACES = ['전체', '거실', '안방', '주방', '현관', '발코니', '드레스룸', '욕실', '기타'];
        const WALLPAPER_TYPES = ['미선택', '일반실크(베스트)', '고급실크(디아망등)', '프리미엄(포티스)', '광폭합지'];

        const FinishItem = ({ type, title, icon, value, options, detailValue, detailOptions, onMainChange, onDetailChange }) => {
            const showDetail = (type === 'wall' && value === '벽지') || (type === 'ceiling' && value === '벽지') || (type === 'floor' && value !== '미선택' && !['도장'].includes(value));
            
            const getFloorDetailOptions = () => {
                if (value === '장판') return ['보급', '표준', '고급'];
                if (value === '강마루') return ['우드타입', '석재타입'];
                if (value === '원목마루') return ['표준', '고급'];
                return [];
            };

            return (
                <div className="bg-gradient-to-br from-slate-50 to-white p-6 rounded-[2rem] border-2 border-slate-100 shadow-sm hover:shadow-md transition-all">
                    <div className="flex items-center gap-3 mb-4">
                        <div className="w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center text-amber-600">
                            <Icon name={icon} size={20} />
                        </div>
                        <h4 className="text-sm font-black text-slate-800">{title}</h4>
                    </div>
                    
                    <select 
                        className="w-full p-3 bg-white border-2 border-slate-200 rounded-xl text-xs font-black outline-none focus:border-amber-400 transition-all mb-3" 
                        value={value} 
                        onChange={(e) => onMainChange(e.target.value)}
                    >
                        {options.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                    </select>

                    {showDetail && (
                        <div className="mt-3 pt-3 border-t border-slate-200">
                            {type === 'floor' ? (
                                <select 
                                    className="w-full p-2.5 bg-amber-50 border border-amber-200 rounded-lg text-[11px] font-black text-amber-700 outline-none" 
                                    value={detailValue || '미선택'} 
                                    onChange={(e) => onDetailChange(e.target.value)}
                                >
                                    {getFloorDetailOptions().length > 0 ? (
                                        getFloorDetailOptions().map(opt => <option key={opt} value={opt}>{opt}</option>)
                                    ) : (
                                        <option value="상담결정">상담 후 결정</option>
                                    )}
                                </select>
                            ) : (
                                <div className="space-y-2">
                                    <p className="text-[10px] font-black text-amber-600 mb-2">도배지 종류</p>
                                    <div className="grid grid-cols-1 gap-1.5">
                                        {detailOptions.map(paper => (
                                            <button
                                                key={paper}
                                                onClick={() => onDetailChange(paper)}
                                                className={`py-2 px-3 rounded-lg text-[10px] font-black border transition-all ${
                                                    detailValue === paper 
                                                        ? 'bg-amber-500 text-white border-amber-500 shadow-sm' 
                                                        : 'bg-white text-slate-500 border-slate-200 hover:border-amber-300'
                                                }`}
                                            >
                                                {paper}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        const App = () => {
            const [formData, setFormData] = useState({
                customerName: '',
                contact: '',
                siteName: '',
                area: '',
                workDate: '',
                budget: '',
                familyCount: '',
                consultantName: '',
                residenceStatus: '공실', 
                buildingType: '아파트', 
                residencePurpose: '주거용',
                floorInfo: '', 
                isOuterWall: false, 
                hasElevator: false,
                notes: '',
                scope: '전체',
                demoNotes: '',
                windowBrand: '', 
                extensions: [],
                kitchenAppliances: [],
                kitchenType: [],
                kitchenHardware: '표준', 
                kitchenCountertop: '인조대리석',
                kitchenExtra: '',
                activeFinishSpace: '전체',
                finishesBySpace: SPACES.reduce((acc, s) => ({
                    ...acc, 
                    [s]: { floor: '미선택', floorOption: '미선택', wall: '미선택', wallpaperTypeWall: '미선택', wallpaperTypeCeiling: '미선택', ceiling: '미선택' }
                }), {}),
                publicBath: {
                    tub: '미선택', partition: '미선택', trench: '일반육가', cabinet: '미선택',
                    tileType: '포세린', tileSize: '600*600', ceiling: '미선택', ventFan: '미선택',
                    toilet: '표준형', sink: '표준형', sinkFaucet: '표준형', isSinkFaucetEmbedded: false,
                    tubFaucet: '표준형', isTubFaucetEmbedded: false, showerHead: '표준형', isShowerHeadEmbedded: false,
                    zendai: '표준형'
                },
                masterBath: {
                    tub: '미선택', partition: '미선택', trench: '일반육가', cabinet: '미선택',
                    tileType: '포세린', tileSize: '600*600', ceiling: '미선택', ventFan: '미선택',
                    toilet: '표준형', sink: '표준형', sinkFaucet: '표준형', isSinkFaucetEmbedded: false,
                    tubFaucet: '표준형', isTubFaucetEmbedded: false, showerHead: '표준형', isShowerHeadEmbedded: false,
                    zendai: '표준형'
                },
                activeSpace: '전체',
                furnitureBySpace: SPACES.reduce((acc, s) => ({ ...acc, [s]: [] }), {}),
                activeDetailSpace: '전체',
                detailsBySpace: SPACES.reduce((acc, s) => ({
                    ...acc, [s]: { lighting: [], electrical: [], carpentry: [], lightingLocations: {} }
                }), {}),
                doorDetailsBySpace: SPACES.reduce((acc, s) => ({
                    ...acc, [s]: { 
                        doorStyle: '미선택', 
                        doorHandle: '일반', 
                        moldingType: '미선택',
                        skirtingType: '미선택',
                        entranceDoor: '미선택'
                    }
                }), {}),
                systemHangerInfo: '',
                airconType: '시스템에어컨',
                airconBrand: 'LG',
                airconCount: 0,
                airconLocation: ''
            });

            const handleInputChange = (e) => {
                const { name, value, type, checked } = e.target;
                setFormData(prev => ({ ...prev, [name]: type === 'checkbox' ? checked : value }));
            };

            const toggleArrayItem = (listName, item) => {
                setFormData(prev => {
                    const current = Array.isArray(prev[listName]) ? prev[listName] : [];
                    return {
                        ...prev,
                        [listName]: current.includes(item) ? current.filter(i => i !== item) : [...current, item]
                    };
                });
            };

            const handleFinishChange = (key, value) => {
                setFormData(prev => ({
                    ...prev,
                    finishesBySpace: {
                        ...prev.finishesBySpace,
                        [prev.activeFinishSpace]: { ...prev.finishesBySpace[prev.activeFinishSpace], [key]: value }
                    }
                }));
            };

            const toggleFurnitureForSpace = (item) => {
                const space = formData.activeSpace;
                setFormData(prev => {
                    const currentFurniture = prev.furnitureBySpace[space] || [];
                    return {
                        ...prev,
                        furnitureBySpace: {
                            ...prev.furnitureBySpace,
                            [space]: currentFurniture.includes(item) ? currentFurniture.filter(i => i !== item) : [...currentFurniture, item]
                        }
                    };
                });
            };

            // 수정된 디테일 토글 로직
            const toggleDetailForSpace = (category, item) => {
                setFormData(prev => {
                    const space = prev.activeDetailSpace;
                    const currentSpace = prev.detailsBySpace[space] || { lighting: [], electrical: [], carpentry: [], lightingLocations: {} };
                    const currentArray = currentSpace[category] || [];
                    
                    return {
                        ...prev,
                        detailsBySpace: {
                            ...prev.detailsBySpace,
                            [space]: {
                                ...currentSpace,
                                [category]: currentArray.includes(item)
                                    ? currentArray.filter(i => i !== item)
                                    : [...currentArray, item]
                            }
                        }
                    };
                });
            };

            const handleDetailLocationChange = (item, value) => {
                setFormData(prev => {
                    const space = prev.activeDetailSpace;
                    const currentSpace = prev.detailsBySpace[space] || { lighting: [], electrical: [], carpentry: [], lightingLocations: {} };
                    return {
                        ...prev,
                        detailsBySpace: {
                            ...prev.detailsBySpace,
                            [space]: {
                                ...currentSpace,
                                lightingLocations: { ...(currentSpace.lightingLocations || {}), [item]: value }
                            }
                        }
                    };
                });
            };

            const handleDoorDetailChange = (key, value) => {
                setFormData(prev => ({
                    ...prev,
                    doorDetailsBySpace: {
                        ...prev.doorDetailsBySpace,
                        [prev.activeDetailSpace]: { 
                            ...(prev.doorDetailsBySpace[prev.activeDetailSpace] || {}), 
                            [key]: value 
                        }
                    }
                }));
            };

            const handleBathChange = (type, key, value) => {
                setFormData(prev => ({ ...prev, [type]: { ...prev[type], [key]: value } }));
            };

            const handlePrint = () => window.print();
            const resetForm = () => { if (window.confirm("시트를 초기화하시겠습니까?")) window.location.reload(); };

            const renderBathSection = (type, title, bgColor, borderColor, textColor) => (
                <div className={`${bgColor} p-6 md:p-8 rounded-[2.5rem] border-2 ${borderColor} relative overflow-hidden group shadow-sm`}>
                    <div className={`absolute top-0 right-0 p-4 opacity-5 group-hover:scale-110 transition-transform ${textColor}`}><Icon name="bath" size={160} /></div>
                    <h3 className={`font-black ${textColor} mb-6 text-xl relative flex items-center gap-2`}><span className={`w-3 h-3 rounded-full bg-current`}></span> {title}</h3>
                    <div className="grid grid-cols-1 gap-8 relative font-bold">
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                            <div className="space-y-4">
                                <div><label className="text-[10px] font-black text-slate-400 uppercase tracking-widest block mb-1">욕조 옵션</label>
                                    <select className="w-full p-3 text-sm bg-white border border-slate-200 rounded-xl outline-none" value={formData[type].tub} onChange={(e) => handleBathChange(type, 'tub', e.target.value)}>
                                        <option value="미선택">욕조 미선택</option><option value="일반욕조">일반 욕조</option><option value="조적욕조">조적 욕조</option><option value="이동식욕조">이동식 욕조</option>
                                    </select>
                                </div>
                                <div><label className="text-[10px] font-black text-slate-400 uppercase tracking-widest block mb-1">파티션 옵션</label>
                                    <select className="w-full p-3 text-sm bg-white border border-slate-200 rounded-xl outline-none" value={formData[type].partition} onChange={(e) => handleBathChange(type, 'partition', e.target.value)}>
                                        <option value="미선택">파티션 미선택</option><option value="강화유리">강화유리</option><option value="조적">조적</option><option value="조적(하프)">조적(하프)</option><option value="조적(하프)+강화유리">조적(하프)+유리</option>
                                    </select>
                                </div>
                            </div>
                            <div className="space-y-4">
                                <div className="grid grid-cols-2 gap-2">
                                    <div><label className="text-[10px] font-black text-slate-400 uppercase tracking-widest block mb-1">타일 종류</label>
                                        <select className="w-full p-3 text-sm bg-white border border-slate-200 rounded-xl outline-none font-bold" value={formData[type].tileType} onChange={(e) => handleBathChange(type, 'tileType', e.target.value)}>
                                            <option value="포세린">포세린</option><option value="세라믹">세라믹</option>
                                        </select>
                                    </div>
                                    <div><label className="text-[10px] font-black text-slate-400 uppercase tracking-widest block mb-1">타일 사이즈</label>
                                        <select className="w-full p-3 text-sm bg-white border border-slate-200 rounded-xl outline-none font-bold" value={formData[type].tileSize} onChange={(e) => handleBathChange(type, 'tileSize', e.target.value)}>
                                            <option value="600*600">600*600</option><option value="600*1200">600*1200</option><option value="300*600">300*600</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen p-4 md:p-8 print:p-0">
                    <div className="max-w-6xl mx-auto space-y-6">
                        <div className="flex justify-end gap-3 no-print">
                            <button onClick={resetForm} className="flex items-center gap-2 px-4 py-2 text-slate-400 hover:text-rose-500 transition-colors font-bold"><Icon name="rotate-ccw" size={18} /><span>초기화</span></button>
                            <button onClick={handlePrint} className="flex items-center gap-2 bg-slate-900 text-white px-7 py-3 rounded-2xl hover:bg-slate-800 shadow-xl transition-all font-bold"><Icon name="printer" size={18} /><span>PDF 저장 / 인쇄</span></button>
                        </div>

                        <header className="bg-white p-8 md:p-12 rounded-[3rem] shadow-sm border border-slate-100 relative overflow-hidden section-break">
                            <div className="absolute top-0 right-0 p-12 opacity-[0.03] rotate-12"><Icon name="home" size={240} /></div>
                            <div className="relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center mb-12 gap-6">
                                <div>
                                    <h1 className="text-4xl font-black tracking-tight text-slate-900 mb-2">토토디자인 미팅 시트</h1>
                                    <div className="flex items-center gap-3">
                                        <span className="h-[2px] w-8 bg-blue-500"></span>
                                        <p className="text-slate-400 font-bold tracking-[0.3em] uppercase text-[10px]">TOTODESIGN INTERIOR STUDIO</p>
                                    </div>
                                </div>
                                <div className="flex flex-col items-end gap-3">
                                    <div className="px-4 py-1.5 bg-slate-100 rounded-full text-[10px] font-black text-slate-500 uppercase tracking-widest">Counseling Sheet</div>
                                    <div className="flex items-center gap-3 bg-slate-50 p-2 pl-4 rounded-2xl border border-slate-100 print:hidden">
                                        <Icon name="briefcase" size={14} className="text-slate-400" />
                                        <input type="text" name="consultantName" value={formData.consultantName} onChange={handleInputChange} placeholder="상담자 성함" className="bg-transparent border-0 text-xs font-black outline-none focus:ring-0 w-32" />
                                    </div>
                                    <p className="hidden print:block text-xs font-black text-slate-400">Counselor: {formData.consultantName || '---'}</p>
                                </div>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-3 gap-5 relative z-10">
                                {[{ label: '고객명', name: 'customerName', icon: 'user' }, { label: '연락처', name: 'contact', icon: 'phone' }, { label: '현장명', name: 'siteName', icon: 'map-pin' }, { label: '공사일정', name: 'workDate', icon: 'calendar', type: 'date' }, { label: '예산(만원)', name: 'budget', icon: 'wallet', type: 'number' }, { label: '가족인원', name: 'familyCount', icon: 'users', type: 'number' }].map(f => (
                                    <div key={f.name} className="group relative bg-slate-50/50 rounded-2xl border border-transparent focus-within:border-blue-200 focus-within:bg-white transition-all p-4">
                                        <div className="flex items-center gap-3 mb-1">
                                            <Icon name={f.icon} size={14} className="text-slate-300 group-focus-within:text-blue-500 transition-colors" />
                                            <span className="text-[9px] font-black text-slate-400 uppercase tracking-wider">{f.label}</span>
                                        </div>
                                        <input type={f.type || 'text'} name={f.name} value={formData[f.name]} onChange={handleInputChange} className="w-full bg-transparent outline-none text-sm font-black text-slate-800" />
                                    </div>
                                ))}
                            </div>
                        </header>

                        {/* 수정된 전기 및 목공 디테일 섹션 */}
                        <section className="bg-white p-6 md:p-8 rounded-[2.5rem] shadow-sm border-t-8 border-rose-500 font-bold section-break">
                            <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-4">
                                <h3 className="font-black text-rose-600 text-xl flex items-center gap-2"><Icon name="zap" size={24} /> 전기 및 목공 디테일</h3>
                                <div className="flex flex-wrap gap-1.5 bg-slate-50 p-2 rounded-[1.5rem] border border-slate-100 print:hidden">
                                    {SPACES.map(space => {
                                        const detail = formData.detailsBySpace[space] || { lighting: [], electrical: [], carpentry: [] };
                                        const count = (detail.lighting?.length || 0) + (detail.electrical?.length || 0) + (detail.carpentry?.length || 0);
                                        return (
                                            <button 
                                                key={space} 
                                                type="button"
                                                onClick={() => setFormData(p => ({ ...p, activeDetailSpace: space }))}
                                                className={`px-4 py-1.5 rounded-full text-[11px] font-black transition-all border ${formData.activeDetailSpace === space ? 'bg-rose-500 text-white border-rose-500 shadow-md' : 'bg-white text-slate-400 border-slate-200 hover:border-rose-200'}`}
                                            >
                                                {space} {count > 0 && <span className="ml-1 opacity-70">({count})</span>}
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>

                            <div className="bg-slate-50/50 p-6 md:p-8 rounded-[2.5rem] border-2 border-slate-100 relative shadow-sm mb-10">
                                <div className="absolute top-6 right-8 opacity-10 flex items-center gap-2 text-rose-300 font-bold"><Icon name="layout" size={40}/><span className="text-2xl font-black uppercase">{formData.activeDetailSpace}</span></div>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8 relative">
                                    {/* 조명 */}
                                    <div>
                                        <h4 className="text-[11px] font-black text-slate-800 mb-5 flex items-center gap-2 font-sans"><Icon name="lightbulb" size={16} className="text-orange-400"/> 공간 조명</h4>
                                        <div className="space-y-3.5">
                                            {['메인등', '매립등(다운)', '간접 조명', '라인 조명', '실링팬'].map(light => {
                                                const detail = formData.detailsBySpace[formData.activeDetailSpace] || {};
                                                const currentLighting = detail.lighting || [];
                                                const isChecked = currentLighting.includes(light);
                                                return (
                                                    <div key={light} className="flex flex-col gap-2">
                                                        <label className="flex items-center gap-3 cursor-pointer group">
                                                            <div className={`w-5 h-5 rounded-lg border-2 flex items-center justify-center transition-all ${isChecked ? 'bg-orange-400 border-orange-400' : 'bg-white border-slate-200'}`}>
                                                                {isChecked && <Icon name="zap" size={10} className="text-white" />}
                                                            </div>
                                                            <input type="checkbox" className="hidden" checked={isChecked} onChange={() => toggleDetailForSpace('lighting', light)}/>
                                                            <span className={`text-[12px] font-black ${isChecked ? 'text-slate-800' : 'text-slate-400'}`}>{light}</span>
                                                        </label>
                                                        {isChecked && (
                                                            <div className="pl-8">
                                                                <input type="text" placeholder="위치 상세" className="w-full p-2 text-[10px] bg-white border-b-2 border-orange-100 outline-none font-bold" value={(detail.lightingLocations || {})[light] || ''} onChange={(e) => handleDetailLocationChange(light, e.target.value)} />
                                                            </div>
                                                        )}
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>

                                    {/* 전기 */}
                                    <div>
                                        <h4 className="text-[11px] font-black text-slate-800 mb-5 flex items-center gap-2 font-sans"><Icon name="cpu" size={16} className="text-teal-500"/> 공간 전기</h4>
                                        <div className="space-y-3">
                                            {['분전함 교체', '단독 배선', '일괄소등 스위치', 'IoT 적용'].map(item => (
                                                <label key={item} className={`flex items-center gap-3 p-3 rounded-2xl border-2 transition-all cursor-pointer ${(formData.detailsBySpace[formData.activeDetailSpace]?.electrical || []).includes(item) ? 'bg-teal-500 border-teal-500 text-white shadow-lg' : 'bg-white border-slate-100 text-slate-400'}`}>
                                                    <input type="checkbox" className="hidden" checked={(formData.detailsBySpace[formData.activeDetailSpace]?.electrical || []).includes(item)} onChange={() => toggleDetailForSpace('electrical', item)} />
                                                    <span className="text-[11px] font-black">{item}</span>
                                                </label>
                                            ))}
                                        </div>
                                    </div>

                                    {/* 목공 */}
                                    <div>
                                        <h4 className="text-[11px] font-black text-slate-800 mb-5 flex items-center gap-2 font-sans"><Icon name="hammer" size={16} className="text-blue-400"/> 공간 목공</h4>
                                        <div className="grid grid-cols-1 gap-2.5">
                                            {['천장 평탄화', '가벽설치', '단열공사', '문틀보강', '아치형 개구부'].map(item => (
                                                <label key={item} className={`flex items-center gap-3 p-3 rounded-2xl border-2 transition-all cursor-pointer ${(formData.detailsBySpace[formData.activeDetailSpace]?.carpentry || []).includes(item) ? 'bg-blue-500 border-blue-500 text-white' : 'bg-white border-slate-100 text-slate-400'}`}><input type="checkbox" className="hidden" checked={(formData.detailsBySpace[formData.activeDetailSpace]?.carpentry || []).includes(item)} onChange={() => toggleDetailForSpace('carpentry', item)} /><span className="text-[11px] font-black">{item}</span></label>
                                            ))}
                                        </div>
                                    </div>

                                    {/* 방문/문선 */}
                                    <div>
                                        <h4 className="text-[11px] font-black text-slate-800 mb-5 flex items-center gap-2 font-sans"><Icon name="box" size={16} className="text-purple-400"/> 방문 및 문선</h4>
                                        <div className="space-y-4">
                                            <div>
                                                <label className="text-[9px] font-black text-slate-400 uppercase mb-2 block">문선 선택</label>
                                                <select className="w-full p-2.5 bg-white border-2 border-slate-100 rounded-xl outline-none text-xs font-black" value={formData.doorDetailsBySpace[formData.activeDetailSpace]?.doorStyle || '미선택'} onChange={(e) => handleDoorDetailChange('doorStyle', e.target.value)}>
                                                    <option value="미선택">미선택</option><option value="일반문">일반문</option><option value="9mm 문선">9mm 문선</option><option value="히든 도어">히든 도어</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label className="text-[9px] font-black text-slate-400 uppercase mb-2 block">도어손잡이</label>
                                                <div className="flex gap-2">
                                                    {['일반', '고급'].map(h => (
                                                        <button key={h} onClick={() => handleDoorDetailChange('doorHandle', h)} className={`flex-1 py-2 text-[10px] font-black border-2 rounded-xl transition-all ${formData.doorDetailsBySpace[formData.activeDetailSpace]?.doorHandle === h ? 'bg-purple-500 text-white border-purple-500' : 'bg-white text-slate-400 border-slate-100'}`}>{h}</button>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* 목공 마감 */}
                                    <div>
                                        <h4 className="text-[11px] font-black text-slate-800 mb-5 flex items-center gap-2 font-sans"><Icon name="scissors" size={16} className="text-amber-400"/> 목공 마감</h4>
                                        <div className="space-y-4">
                                            <div>
                                                <label className="text-[9px] font-black text-slate-400 uppercase mb-2 block">몰딩</label>
                                                <select className="w-full p-2.5 bg-white border-2 border-slate-100 rounded-xl outline-none text-xs font-black" value={formData.doorDetailsBySpace[formData.activeDetailSpace]?.moldingType || '미선택'} onChange={(e) => handleDoorDetailChange('moldingType', e.target.value)}>
                                                    <option value="미선택">미선택</option><option value="무몰딩">무몰딩</option><option value="일반몰딩">일반몰딩</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label className="text-[9px] font-black text-slate-400 uppercase mb-2 block">현관 중문</label>
                                                <select className="w-full p-2.5 bg-white border-2 border-slate-100 rounded-xl outline-none text-xs font-black" value={formData.doorDetailsBySpace[formData.activeDetailSpace]?.entranceDoor || '미선택'} onChange={(e) => handleDoorDetailChange('entranceDoor', e.target.value)}>
                                                    <option value="미선택">미선택</option><option value="3연동">3연동</option><option value="원슬라이딩">원슬라이딩</option><option value="여닫이">여닫이</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* 요약 섹션 */}
                            <div className="mt-8 pt-6 border-t-2 border-rose-200 bg-rose-50/30 rounded-2xl p-6">
                                <p className="text-[10px] font-black text-rose-600 uppercase tracking-widest mb-4 flex items-center gap-2"><Icon name="file-text" size={14} /> 전기 및 목공 디테일 요약</p>
                                <div className="space-y-4">
                                    {Object.entries(formData.detailsBySpace).map(([space, data]) => {
                                        const doorData = formData.doorDetailsBySpace[space] || {};
                                        const hasContent = (data.lighting?.length || 0) > 0 || (data.electrical?.length || 0) > 0 || (data.carpentry?.length || 0) > 0 || (doorData.doorStyle && doorData.doorStyle !== '미선택') || (doorData.entranceDoor && doorData.entranceDoor !== '미선택');
                                        if (!hasContent) return null;
                                        return (
                                            <div key={space} className="border-b border-rose-100 pb-3 last:border-0">
                                                <div className="font-black text-rose-600 text-xs mb-2">[{space}]</div>
                                                <div className="space-y-1 text-xs text-slate-700 ml-2">
                                                    {data.lighting?.length > 0 && <div><span className="font-bold text-orange-500">[조명]</span> {data.lighting.map(l => `${l}${data.lightingLocations?.[l] ? `(${data.lightingLocations[l]})` : ''}`).join(', ')}</div>}
                                                    {data.electrical?.length > 0 && <div><span className="font-bold text-teal-600">[전기]</span> {data.electrical.join(', ')}</div>}
                                                    {data.carpentry?.length > 0 && <div><span className="font-bold text-blue-500">[목공]</span> {data.carpentry.join(', ')}</div>}
                                                    {doorData.doorStyle && doorData.doorStyle !== '미선택' && <div><span className="font-bold text-purple-500">[문선]</span> {doorData.doorStyle}</div>}
                                                    {doorData.entranceDoor && doorData.entranceDoor !== '미선택' && <div><span className="font-bold text-rose-500">[현관중문]</span> {doorData.entranceDoor}</div>}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        </section>

                        {/* 나머지 섹션들... (유지) */}
                        <footer className="py-12 text-center text-slate-300 border-t border-slate-100 mt-12 font-bold font-sans">
                            <p className="text-xs font-black tracking-[0.4em] uppercase mb-2">TOTODESIGN INTERIOR STUDIO</p>
                            <p className="text-[10px]">본 시트는 상담 가이드용이며, 상세 내역은 확정 도면 및 견적서를 기준으로 합니다.</p>
                        </footer>
                    </div>
                    <button onClick={handlePrint} className="fixed bottom-6 right-6 bg-slate-900 text-white p-4 rounded-full shadow-2xl md:hidden hover:scale-110 active:scale-95 transition-all print:hidden z-50"><Icon name="save" size={24} /></button>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
