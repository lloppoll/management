<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>토토디자인 미팅 상담 시트</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        
        :root {
            --brand-primary: #1e293b;
            --brand-accent: #f59e0b;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
            background-color: #f1f5f9;
            color: #334155;
            -webkit-font-smoothing: antialiased;
        }

        /* 부드러운 스크롤 및 커스텀 스크롤바 */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

        /* 입력 필드 포커스 효과 */
        .input-focus-effect {
            transition: all 0.2s ease;
        }
        .input-focus-effect:focus {
            box-shadow: 0 0 0 4px rgba(30, 41, 59, 0.05);
            border-color: #94a3b8;
        }

        @media print {
            .no-print { display: none !important; }
            body { background-color: white; padding: 0; }
            section, .section-break {
                page-break-inside: avoid !important;
                break-inside: avoid-page !important;
                margin-bottom: 2rem;
            }
            .card {
                box-shadow: none !important;
                border: 1px solid #e2e8f0 !important;
            }
        }

        .summary-box {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 1.5rem;
            padding: 1.25rem;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo, useRef } = React;

        // 아이콘 컴포넌트
        const Icon = ({ name, size = 20, className = "" }) => {
            const containerRef = useRef(null);
            useEffect(() => {
                const renderIcon = () => {
                    if (window.lucide && containerRef.current) {
                        containerRef.current.innerHTML = `<i data-lucide="${name}" class="${className}" style="width: ${size}px; height: ${size}px;"></i>`;
                        window.lucide.createIcons({ root: containerRef.current });
                    }
                };
                renderIcon();
                if (!window.lucide) {
                    const checkLucide = setInterval(() => {
                        if (window.lucide) { renderIcon(); clearInterval(checkLucide); }
                    }, 100);
                    return () => clearInterval(checkLucide);
                }
            }, [name, size, className]);
            return <span ref={containerRef} className="inline-flex items-center justify-center flex-shrink-0" style={{ width: size, height: size }} />;
        };

        const SPACES = ['전체', '거실', '안방', '주방', '현관', '발코니', '드레스룸', '욕실', '기타'];
        const WALLPAPER_TYPES = ['미선택', '일반실크', '고급실크', '프리미엄', '광폭합지'];

        const SectionHeader = ({ icon, title, subTitle, colorClass = "text-slate-800" }) => (
            <div className="flex items-center gap-4 mb-8">
                <div className={`p-3 rounded-2xl bg-white shadow-sm border border-slate-100 ${colorClass}`}>
                    <Icon name={icon} size={24} />
                </div>
                <div>
                    <h3 className={`text-xl font-bold tracking-tight ${colorClass}`}>{title}</h3>
                    {subTitle && <p className="text-xs text-slate-400 font-medium uppercase tracking-widest mt-0.5">{subTitle}</p>}
                </div>
            </div>
        );

        const FinishItem = ({ type, title, icon, value, options, detailValue, detailOptions, onMainChange, onDetailChange }) => {
            const showDetail = (type === 'wall' && value === '벽지') || (type === 'ceiling' && value === '벽지') || (type === 'floor' && value !== '미선택' && !['도장'].includes(value));
            
            const getFloorDetailOptions = () => {
                if (value === '장판') return ['보급', '표준', '고급'];
                if (value === '강마루') return ['우드타입', '석재타입'];
                if (value === '원목마루') return ['표준', '고급'];
                return [];
            };

            return (
                <div className="group bg-white p-5 rounded-[2rem] border border-slate-100 shadow-sm hover:shadow-md transition-all duration-300">
                    <div className="flex items-center gap-3 mb-4">
                        <div className="w-9 h-9 bg-slate-50 rounded-xl flex items-center justify-center text-slate-400 group-hover:text-amber-500 group-hover:bg-amber-50 transition-colors">
                            <Icon name={icon} size={18} />
                        </div>
                        <h4 className="text-sm font-bold text-slate-700">{title}</h4>
                    </div>
                    
                    <select 
                        className="w-full p-3 bg-slate-50 border border-transparent rounded-xl text-xs font-bold outline-none input-focus-effect appearance-none cursor-pointer" 
                        value={value || '미선택'} 
                        onChange={(e) => onMainChange(e.target.value)}
                    >
                        {options.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                    </select>

                    {showDetail && (
                        <div className="mt-4 pt-4 border-t border-slate-50 space-y-3">
                            {type === 'floor' ? (
                                <div className="relative">
                                    <p className="text-[10px] font-bold text-slate-400 mb-2 px-1">상세 사양</p>
                                    <select 
                                        className="w-full p-2.5 bg-amber-50/50 border border-amber-100 rounded-lg text-[11px] font-bold text-amber-700 outline-none cursor-pointer" 
                                        value={detailValue || '미선택'} 
                                        onChange={(e) => onDetailChange(e.target.value)}
                                    >
                                        <option value="미선택">옵션 선택</option>
                                        {getFloorDetailOptions().map(opt => <option key={opt} value={opt}>{opt}</option>)}
                                    </select>
                                </div>
                            ) : (
                                <div>
                                    <p className="text-[10px] font-bold text-slate-400 mb-2 px-1">벽지 등급</p>
                                    <div className="flex flex-wrap gap-1.5">
                                        {detailOptions.map(paper => (
                                            <button
                                                key={paper}
                                                type="button"
                                                onClick={() => onDetailChange(paper)}
                                                className={`px-3 py-1.5 rounded-lg text-[10px] font-bold border transition-all ${
                                                    detailValue === paper 
                                                        ? 'bg-amber-500 text-white border-amber-500 shadow-sm' 
                                                        : 'bg-white text-slate-500 border-slate-200 hover:border-amber-300'
                                                }`}
                                            >
                                                {paper}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        const App = () => {
            const [formData, setFormData] = useState({
                customerName: '', contact: '', siteName: '', area: '', workDate: '', budget: '', familyCount: '', consultantName: '',
                residenceStatus: '공실', buildingType: '아파트', residencePurpose: '주거용',
                floorInfo: '', isOuterWall: false, hasElevator: false, notes: '',
                scope: '전체', demoNotes: '', windowBrand: '', extensions: [],
                kitchenAppliances: [], kitchenType: [], kitchenHardware: '표준', kitchenCountertop: '인조대리석', kitchenExtra: '',
                activeFinishSpace: '전체',
                finishesBySpace: SPACES.reduce((acc, s) => ({
                    ...acc, [s]: { floor: '미선택', floorOption: '미선택', wall: '미선택', wallpaperTypeWall: '미선택', wallpaperTypeCeiling: '미선택', ceiling: '미선택' }
                }), {}),
                publicBath: {
                    tub: '미선택', partition: '미선택', trench: '일반육가', cabinet: '미선택', tileType: '포세린', tileSize: '600*600',
                    ceiling: '미선택', ventFan: '미선택', toilet: '표준형', sink: '표준형', sinkFaucet: '표준형', isSinkFaucetEmbedded: false,
                    tubFaucet: '표준형', isTubFaucetEmbedded: false, showerHead: '표준형', isShowerHeadEmbedded: false, zendai: false
                },
                masterBath: {
                    tub: '미선택', partition: '미선택', trench: '일반육가', cabinet: '미선택', tileType: '포세린', tileSize: '600*600',
                    ceiling: '미선택', ventFan: '미선택', toilet: '표준형', sink: '표준형', sinkFaucet: '표준형', isSinkFaucetEmbedded: false,
                    tubFaucet: '표준형', isTubFaucetEmbedded: false, showerHead: '표준형', isShowerHeadEmbedded: false, zendai: false
                },
                activeSpace: '전체',
                furnitureBySpace: SPACES.reduce((acc, s) => ({ ...acc, [s]: [] }), {}),
                activeDetailSpace: '전체',
                detailsBySpace: SPACES.reduce((acc, s) => ({
                    ...acc, [s]: { lighting: [], electrical: [], carpentry: [], lightingLocations: {} }
                }), {}),
                doorDetailsBySpace: SPACES.reduce((acc, s) => ({
                    ...acc, [s]: { doorStyle: '미선택', doorHandle: '일반', moldingType: '미선택', skirtingType: '미선택', entranceDoor: '미선택' }
                }), {}),
                systemHangerInfo: '', airconType: '시스템에어컨', airconBrand: 'LG', airconCount: 0, airconLocation: ''
            });

            const handleInputChange = (e) => {
                const { name, value, type, checked } = e.target;
                setFormData(prev => ({ ...prev, [name]: type === 'checkbox' ? checked : value }));
            };

            const toggleArrayItem = (listName, item) => {
                setFormData(prev => {
                    const current = Array.isArray(prev[listName]) ? prev[listName] : [];
                    const exists = current.includes(item);
                    return { ...prev, [listName]: exists ? current.filter(i => i !== item) : [...current, item] };
                });
            };

            const handleFinishChange = (key, value) => {
                const space = formData.activeFinishSpace;
                setFormData(prev => ({
                    ...prev,
                    finishesBySpace: {
                        ...prev.finishesBySpace,
                        [space]: { ...(prev.finishesBySpace[space] || {}), [key]: value }
                    }
                }));
            };

            const toggleFurnitureForSpace = (item) => {
                const space = formData.activeSpace;
                setFormData(prev => {
                    const currentFurniture = prev.furnitureBySpace[space] || [];
                    return {
                        ...prev,
                        furnitureBySpace: {
                            ...prev.furnitureBySpace,
                            [space]: currentFurniture.includes(item) ? currentFurniture.filter(i => i !== item) : [...currentFurniture, item]
                        }
                    };
                });
            };

            const toggleDetailForSpace = (category, item) => {
                const space = formData.activeDetailSpace;
                setFormData(prev => {
                    const currentSpaceData = prev.detailsBySpace[space] || { lighting: [], electrical: [], carpentry: [], lightingLocations: {} };
                    const currentCategoryList = Array.isArray(currentSpaceData[category]) ? currentSpaceData[category] : [];
                    return {
                        ...prev,
                        detailsBySpace: {
                            ...prev.detailsBySpace,
                            [space]: {
                                ...currentSpaceData,
                                [category]: currentCategoryList.includes(item) ? currentCategoryList.filter(i => i !== item) : [...currentCategoryList, item]
                            }
                        }
                    };
                });
            };

            const handleDetailLocationChange = (item, value) => {
                const space = formData.activeDetailSpace;
                setFormData(prev => {
                    const currentSpaceData = prev.detailsBySpace[space] || { lighting: [], electrical: [], carpentry: [], lightingLocations: {} };
                    return {
                        ...prev,
                        detailsBySpace: {
                            ...prev.detailsBySpace,
                            [space]: { ...currentSpaceData, lightingLocations: { ...(currentSpaceData.lightingLocations || {}), [item]: value } }
                        }
                    };
                });
            };

            const handleBathChange = (type, key, value) => {
                setFormData(prev => ({ ...prev, [type]: { ...(prev[type] || {}), [key]: value } }));
            };

            const handleDoorDetailChange = (key, value) => {
                const space = formData.activeDetailSpace;
                setFormData(prev => ({
                    ...prev,
                    doorDetailsBySpace: {
                        ...prev.doorDetailsBySpace,
                        [space]: { ...(prev.doorDetailsBySpace[space] || {}), [key]: value }
                    }
                }));
            };

            const handlePrint = () => window.print();
            const resetForm = () => { if (window.confirm("시트를 초기화하시겠습니까?")) window.location.reload(); };

            const activeFinishes = formData.finishesBySpace[formData.activeFinishSpace] || {};

            const renderBathSection = (type, title, accentColor) => {
                const bathData = formData[type] || {};
                const colorMap = {
                    indigo: { bg: 'bg-indigo-50/50', border: 'border-indigo-100', text: 'text-indigo-600', accent: 'bg-indigo-600' },
                    purple: { bg: 'bg-purple-50/50', border: 'border-purple-100', text: 'text-purple-600', accent: 'bg-purple-600' }
                };
                const colors = colorMap[accentColor];

                return (
                    <div className={`${colors.bg} p-8 rounded-[3rem] border ${colors.border} relative overflow-hidden section-break`}>
                        <h3 className={`text-xl font-extrabold ${colors.text} mb-8 flex items-center gap-3`}>
                            <span className={`w-2 h-6 ${colors.accent} rounded-full`}></span> {title}
                        </h3>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                            <div className="space-y-5">
                                {[
                                    { label: '욕조', key: 'tub', opts: ['미선택', '일반욕조', '조적욕조', '이동식욕조'] },
                                    { label: '파티션', key: 'partition', opts: ['미선택', '강화유리', '조적', '조적(하프)', '조적(하프)+유리'] },
                                    { label: '수납장', key: 'cabinet', opts: ['미선택', '슬라이딩장', '장거울통일', '장거울따로', '여닫이장', '플랩장'] }
                                ].map(field => (
                                    <div key={field.key}>
                                        <label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-2 px-1">{field.label}</label>
                                        <select className="w-full p-3.5 bg-white border border-slate-100 rounded-2xl text-xs font-bold outline-none shadow-sm cursor-pointer" value={bathData[field.key] || '미선택'} onChange={(e) => handleBathChange(type, field.key, e.target.value)}>
                                            {field.opts.map(o => <option key={o} value={o}>{o}</option>)}
                                        </select>
                                    </div>
                                ))}
                            </div>
                            <div className="space-y-5">
                                <div className="grid grid-cols-2 gap-4">
                                    <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-2 px-1">타일 종류</label>
                                        <select className="w-full p-3.5 bg-white border border-slate-100 rounded-2xl text-xs font-bold outline-none shadow-sm" value={bathData.tileType || '포세린'} onChange={(e) => handleBathChange(type, 'tileType', e.target.value)}>
                                            <option value="포세린">포세린</option><option value="세라믹">세라믹</option>
                                        </select>
                                    </div>
                                    <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-2 px-1">타일 사이즈</label>
                                        <select className="w-full p-3.5 bg-white border border-slate-100 rounded-2xl text-xs font-bold outline-none shadow-sm" value={bathData.tileSize || '600*600'} onChange={(e) => handleBathChange(type, 'tileSize', e.target.value)}>
                                            <option value="600*600">600*600</option><option value="600*1200">600*1200</option><option value="300*600">300*600</option>
                                        </select>
                                    </div>
                                </div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-2 px-1">천장</label>
                                        <select className="w-full p-3.5 bg-white border border-slate-100 rounded-2xl text-xs font-bold outline-none shadow-sm" value={bathData.ceiling || '미선택'} onChange={(e) => handleBathChange(type, 'ceiling', e.target.value)}>
                                            <option value="미선택">미선택</option><option value="SMC">SMC</option><option value="PVC 돔">PVC 돔</option><option value="이노솔">이노솔</option><option value="간접조명">간접조명</option>
                                        </select>
                                    </div>
                                    <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-2 px-1">환풍기</label>
                                        <select className="w-full p-3.5 bg-white border border-slate-100 rounded-2xl text-xs font-bold outline-none shadow-sm" value={bathData.ventFan || '미선택'} onChange={(e) => handleBathChange(type, 'ventFan', e.target.value)}>
                                            <option value="미선택">미선택</option><option value="표준">표준형</option><option value="고급">고급형</option>
                                        </select>
                                    </div>
                                </div>
                                <div><label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-2 px-1">육가</label>
                                    <select className="w-full p-3.5 bg-white border border-slate-100 rounded-2xl text-xs font-bold outline-none shadow-sm" value={bathData.trench || '일반육가'} onChange={(e) => handleBathChange(type, 'trench', e.target.value)}>
                                        <option value="일반육가">일반 육가</option><option value="트렌치육가">트렌치 육가</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div className="mt-10 bg-white/60 p-6 rounded-[2.5rem] border border-white/50">
                            <p className="text-[11px] font-extrabold text-slate-500 uppercase tracking-[0.2em] mb-6 border-b border-slate-100 pb-3">Fitting & Faucet 사양</p>
                            <div className="space-y-1">
                                {[
                                    { label: '양변기', key: 'toilet', type: 'toggle' },
                                    { label: '세면대', key: 'sink', type: 'toggle' },
                                    { label: '세면수전', key: 'sinkFaucet', type: 'toggle', hasEmbed: true, embedKey: 'isSinkFaucetEmbedded' },
                                    { label: '욕조수전', key: 'tubFaucet', type: 'toggle', hasEmbed: true, embedKey: 'isTubFaucetEmbedded' },
                                    { label: '샤워기(슬바)', key: 'showerHead', type: 'toggle', hasEmbed: true, embedKey: 'isShowerHeadEmbedded' },
                                    { label: '젠다이 설치', key: 'zendai', type: 'checkbox' }
                                ].map((item) => (
                                    <div key={item.key} className="flex flex-col sm:flex-row sm:items-center justify-between gap-4 py-3 border-b border-slate-100/50 last:border-0 hover:bg-white/30 px-2 rounded-xl transition-colors">
                                        <span className="text-[13px] font-bold text-slate-700">{item.label}</span>
                                        <div className="flex flex-wrap items-center gap-4">
                                            {item.type === 'toggle' ? (
                                                <div className="flex gap-1 p-1 bg-slate-200/50 rounded-xl">
                                                    {['표준형', '고급형'].map(opt => (
                                                        <button key={opt} type="button" onClick={() => handleBathChange(type, item.key, opt)} className={`px-5 py-1.5 rounded-lg text-[10px] font-bold transition-all ${bathData[item.key] === opt ? 'bg-white text-slate-900 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}>{opt}</button>
                                                    ))}
                                                </div>
                                            ) : (
                                                <label className="flex items-center gap-2 cursor-pointer group">
                                                    <div className={`w-10 h-6 rounded-full relative transition-all ${bathData[item.key] ? 'bg-indigo-500' : 'bg-slate-300'}`}>
                                                        <div className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-all ${bathData[item.key] ? 'left-5' : 'left-1'}`}></div>
                                                    </div>
                                                    <input type="checkbox" className="hidden" checked={!!bathData[item.key]} onChange={(e) => handleBathChange(type, item.key, e.target.checked)} />
                                                    <span className={`text-[11px] font-bold ${bathData[item.key] ? 'text-indigo-600' : 'text-slate-400'}`}>{bathData[item.key] ? '설치' : '미설치'}</span>
                                                </label>
                                            )}

                                            {item.hasEmbed && (
                                                <label className="flex items-center gap-2 cursor-pointer group ml-2">
                                                    <div className={`w-5 h-5 rounded-lg border-2 flex items-center justify-center transition-all ${bathData[item.embedKey] ? 'bg-indigo-500 border-indigo-500' : 'bg-white border-slate-200'}`}>
                                                        {bathData[item.embedKey] && <Icon name="check" size={12} className="text-white" />}
                                                    </div>
                                                    <input type="checkbox" className="hidden" checked={!!bathData[item.embedKey]} onChange={(e) => handleBathChange(type, item.embedKey, e.target.checked)} />
                                                    <span className={`text-[11px] font-bold ${bathData[item.embedKey] ? 'text-indigo-600' : 'text-slate-400 group-hover:text-slate-600'}`}>매립형</span>
                                                </label>
                                            )}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen p-4 md:p-10 lg:p-16 print:p-0">
                    <div className="max-w-6xl mx-auto space-y-10">
                        
                        {/* 상단 액션바 */}
                        <div className="flex justify-end gap-3 no-print">
                            <button onClick={resetForm} className="flex items-center gap-2 px-5 py-2.5 text-slate-500 hover:text-rose-500 hover:bg-rose-50 rounded-2xl transition-all font-bold"><Icon name="rotate-ccw" size={18} /><span>초기화</span></button>
                            <button onClick={handlePrint} className="flex items-center gap-2 bg-slate-900 text-white px-8 py-3.5 rounded-[1.5rem] hover:bg-slate-800 shadow-xl hover:shadow-slate-200 transition-all font-bold"><Icon name="printer" size={18} /><span>상담 시트 PDF 저장</span></button>
                        </div>

                        {/* 헤더 섹션 */}
                        <header className="bg-white p-10 md:p-16 rounded-[4rem] shadow-xl shadow-slate-200/50 border border-slate-100 relative overflow-hidden section-break">
                            <div className="relative z-10 flex flex-col md:flex-row justify-between items-start md:items-end mb-16 gap-8">
                                <div className="space-y-4">
                                    <div className="flex items-center gap-3">
                                        <div className="w-12 h-1.5 bg-amber-500 rounded-full"></div>
                                        <p className="text-slate-400 font-extrabold tracking-[0.4em] uppercase text-[11px]">Interior Consultation System</p>
                                    </div>
                                    <h1 className="text-5xl font-black tracking-tight text-slate-900">토토디자인 미팅 시트</h1>
                                    <p className="text-slate-400 font-medium">고객님의 공간을 디자인하기 위한 첫 걸음, 상세 상담 내용을 기록합니다.</p>
                                </div>
                                <div className="flex flex-col items-end gap-4">
                                    <div className="flex items-center gap-3 bg-slate-50 p-2.5 pl-5 rounded-[1.5rem] border border-slate-100 focus-within:border-slate-300 transition-all print:hidden">
                                        <Icon name="briefcase" size={16} className="text-slate-400" />
                                        <input type="text" name="consultantName" value={formData.consultantName} onChange={handleInputChange} placeholder="상담자 성함" className="bg-transparent border-0 text-sm font-bold outline-none focus:ring-0 w-36" />
                                    </div>
                                    <p className="hidden print:block text-sm font-bold text-slate-500 bg-slate-100 px-4 py-1.5 rounded-full">Consultant: {formData.consultantName || '---'}</p>
                                </div>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10">
                                {[
                                    { label: '고객명', name: 'customerName', icon: 'user' },
                                    { label: '연락처', name: 'contact', icon: 'phone' },
                                    { label: '현장명', name: 'siteName', icon: 'map-pin' },
                                    { label: '공사일정', name: 'workDate', icon: 'calendar', type: 'date' },
                                    { label: '예산(만원)', name: 'budget', icon: 'wallet', type: 'number' },
                                    { label: '가족인원', name: 'familyCount', icon: 'users', type: 'number' }
                                ].map(f => (
                                    <div key={f.name} className="group bg-slate-50/50 rounded-[2rem] border border-transparent focus-within:border-slate-200 focus-within:bg-white focus-within:shadow-sm transition-all p-6">
                                        <div className="flex items-center gap-3 mb-2">
                                            <Icon name={f.icon} size={16} className="text-slate-300 group-focus-within:text-slate-900 transition-colors" />
                                            <span className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">{f.label}</span>
                                        </div>
                                        <input type={f.type || 'text'} name={f.name} value={formData[f.name]} onChange={handleInputChange} className="w-full bg-transparent outline-none text-base font-bold text-slate-800 placeholder-slate-300" placeholder={`${f.label} 입력`} />
                                    </div>
                                ))}
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-8 relative z-10">
                                <div className="bg-white rounded-[2rem] border border-slate-100 shadow-sm p-6 flex flex-col justify-between group hover:border-amber-200 transition-all">
                                    <div className="flex items-center gap-3 mb-4">
                                        <div className="p-2.5 bg-amber-50 rounded-xl text-amber-500"><Icon name="home" size={20} /></div>
                                        <span className="text-[10px] font-bold text-slate-400 tracking-widest uppercase">분양 평수</span>
                                    </div>
                                    <div className="flex items-end gap-2">
                                        <input type="number" name="area" value={formData.area} onChange={handleInputChange} placeholder="00" className="w-full bg-transparent outline-none text-3xl font-black text-slate-800 placeholder-slate-200" />
                                        <span className="text-lg font-bold text-slate-400 mb-1">평</span>
                                    </div>
                                </div>
                                
                                <div className="bg-white rounded-[2rem] border border-slate-100 shadow-sm p-6 hover:border-blue-200 transition-all">
                                    <div className="flex items-center gap-3 mb-4">
                                        <div className="p-2.5 bg-blue-50 rounded-xl text-blue-500"><Icon name="target" size={20} /></div>
                                        <span className="text-[10px] font-bold text-slate-400 tracking-widest uppercase">공사 목적</span>
                                    </div>
                                    <div className="flex flex-wrap gap-2">
                                        {['주거용', '매매계획', '임대용'].map(p => (
                                            <label key={p} className={`px-4 py-2 rounded-xl text-xs font-bold border transition-all cursor-pointer ${formData.residencePurpose === p ? 'bg-blue-600 border-blue-600 text-white shadow-md' : 'bg-slate-50 border-transparent text-slate-500 hover:border-blue-200'}`}>
                                                <input type="radio" name="residencePurpose" value={p} checked={formData.residencePurpose === p} onChange={handleInputChange} className="hidden" />
                                                {p}
                                            </label>
                                        ))}
                                    </div>
                                </div>
                                
                                <div className="bg-white rounded-[2rem] border border-slate-100 shadow-sm p-6 hover:border-purple-200 transition-all">
                                    <div className="flex items-center gap-3 mb-4">
                                        <div className="p-2.5 bg-purple-50 rounded-xl text-purple-500"><Icon name="building" size={20} /></div>
                                        <span className="text-[10px] font-bold text-slate-400 tracking-widest uppercase">유형 & 층수</span>
                                    </div>
                                    <div className="flex items-center gap-3">
                                        <select name="buildingType" value={formData.buildingType} onChange={handleInputChange} className="flex-1 bg-slate-50 border-0 rounded-xl px-4 py-2.5 text-xs font-bold text-slate-700 outline-none focus:ring-2 focus:ring-purple-100">
                                            {['아파트', '주택', '빌라', '상가', '기타'].map(type => (<option key={type} value={type}>{type}</option>))}
                                        </select>
                                        <div className="flex items-center gap-1">
                                            <input type="text" name="floorInfo" value={formData.floorInfo} onChange={handleInputChange} placeholder="00" className="w-10 bg-transparent text-lg font-black text-purple-600 text-center outline-none" />
                                            <span className="text-xs font-bold text-purple-400">층</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="bg-white rounded-[2rem] border border-slate-100 shadow-sm p-6 hover:border-emerald-200 transition-all">
                                    <div className="flex items-center gap-3 mb-4">
                                        <div className="p-2.5 bg-emerald-50 rounded-xl text-emerald-500"><Icon name="settings" size={20} /></div>
                                        <span className="text-[10px] font-bold text-slate-400 tracking-widest uppercase">현장 옵션</span>
                                    </div>
                                    <div className="flex flex-col gap-2">
                                        {[
                                            { name: 'hasElevator', label: '엘리베이터', icon: 'arrow-up-square' },
                                            { name: 'isOuterWall', label: '외벽 라인', icon: 'thermometer-snowflake' }
                                        ].map(opt => (
                                            <label key={opt.name} className="flex items-center justify-between cursor-pointer group">
                                                <div className="flex items-center gap-2">
                                                    <Icon name={opt.icon} size={14} className={formData[opt.name] ? "text-emerald-500" : "text-slate-300"} />
                                                    <span className={`text-xs font-bold ${formData[opt.name] ? 'text-slate-900' : 'text-slate-400'}`}>{opt.label}</span>
                                                </div>
                                                <div className={`w-10 h-5 rounded-full relative transition-all ${formData[opt.name] ? 'bg-emerald-500' : 'bg-slate-200'}`}>
                                                    <div className={`absolute top-1 w-3 h-3 bg-white rounded-full transition-all ${formData[opt.name] ? 'left-6' : 'left-1'}`}></div>
                                                </div>
                                                <input type="checkbox" name={opt.name} checked={!!formData[opt.name]} onChange={handleInputChange} className="hidden" />
                                            </label>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            <div className="mt-8 relative z-10">
                                <label className="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-2 px-1">기타 참고사항</label>
                                <textarea name="notes" value={formData.notes} onChange={handleInputChange} placeholder="현장 특이사항 및 상담 메모..." className="w-full p-6 bg-slate-50 border border-transparent rounded-[2rem] h-24 focus:bg-white focus:border-slate-200 focus:shadow-inner outline-none transition-all font-medium text-sm text-slate-600" />
                            </div>
                        </header>

                        {/* 철거 및 확장 공사 섹션 */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-10">
                            <section className="lg:col-span-1 bg-white p-8 rounded-[3.5rem] shadow-sm border border-slate-100 section-break">
                                <SectionHeader title="철거 범위" subTitle="Demolition Scope" icon="trash-2" colorClass="text-slate-900" />
                                <div className="space-y-6">
                                    <div className="flex gap-2 p-1.5 bg-slate-50 rounded-2xl">
                                        {['전체', '부분'].map(s => (
                                            <button key={s} type="button" onClick={() => setFormData(p => ({...p, scope: s}))} className={`flex-1 py-3 rounded-xl font-bold transition-all ${formData.scope === s ? 'bg-white text-slate-900 shadow-sm' : 'text-slate-400 hover:text-slate-600'}`}>{s}</button>
                                        ))}
                                    </div>
                                    <textarea name="demoNotes" value={formData.demoNotes} onChange={handleInputChange} placeholder="구체적인 철거 항목 기입..." className="w-full p-5 bg-slate-50 border border-transparent rounded-[2rem] h-48 focus:bg-white focus:border-slate-100 outline-none text-sm font-medium text-slate-500" />
                                </div>
                            </section>

                            <section className="lg:col-span-2 bg-white p-8 rounded-[3.5rem] shadow-sm border border-slate-100 section-break">
                                <SectionHeader title="창호 및 확장 공사" subTitle="Windows & Expansion" icon="wind" colorClass="text-blue-600" />
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                                    <div>
                                        <p className="text-[10px] font-extrabold text-slate-400 uppercase tracking-widest mb-4 px-1">창호 브랜드 선택</p>
                                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                            {[{ name: 'LX하우시스', sub: '20%▲' }, { name: '이건창호', sub: '10%▲' }, { name: 'KCC', sub: '표준' }, { name: '기타', sub: '-' }].map(brand => (
                                                <button
                                                    key={brand.name}
                                                    onClick={() => setFormData(p => ({ ...p, windowBrand: brand.name }))}
                                                    className={`p-5 rounded-[2rem] border transition-all text-left group ${formData.windowBrand === brand.name ? 'border-blue-500 bg-blue-50/50 ring-4 ring-blue-50' : 'border-slate-100 bg-white hover:border-blue-200'}`}
                                                >
                                                    <p className={`font-bold text-sm ${formData.windowBrand === brand.name ? 'text-blue-700' : 'text-slate-700'}`}>{brand.name}</p>
                                                    <p className="text-[10px] font-bold text-slate-400 mt-1 uppercase">{brand.sub}</p>
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                    <div>
                                        <p className="text-[10px] font-extrabold text-slate-400 uppercase tracking-widest mb-4 px-1">확장 예정 공간</p>
                                        <div className="grid grid-cols-2 sm:grid-cols-3 gap-2">
                                            {['거실', '주방', '안방', '침실1', '침실2', '발코니'].map(room => (
                                                <label key={room} className={`flex items-center justify-center p-4 border-2 rounded-2xl cursor-pointer transition-all ${ (formData.extensions || []).includes(room) ? 'bg-orange-500 border-orange-500 text-white shadow-lg shadow-orange-100 scale-105' : 'bg-slate-50 border-transparent text-slate-500 hover:border-orange-200' }`}>
                                                    <input type="checkbox" checked={(formData.extensions || []).includes(room)} onChange={() => toggleArrayItem('extensions', room)} className="hidden" />
                                                    <span className="text-xs font-extrabold">{room}</span>
                                                </label>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>

                        {/* 냉방 가전 및 주방 섹션 */}
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-10">
                            <section className="bg-white p-8 rounded-[3.5rem] shadow-sm border border-slate-100 section-break">
                                <SectionHeader title="냉방 시스템 계획" subTitle="Air Conditioning" icon="snowflake" colorClass="text-cyan-600" />
                                <div className="space-y-8">
                                    <div className="flex gap-3 p-1.5 bg-slate-50 rounded-[1.5rem]">
                                        {['시스템에어컨', '스탠드/벽걸이'].map(type => (
                                            <button key={type} onClick={() => setFormData(prev => ({ ...prev, airconType: type }))} className={`flex-1 py-3.5 rounded-xl font-bold transition-all ${formData.airconType === type ? 'bg-white text-cyan-600 shadow-sm' : 'text-slate-400 hover:text-slate-600'}`}>{type}</button>
                                        ))}
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        {formData.airconType === '시스템에어컨' ? (
                                            <div className="space-y-4">
                                                <div>
                                                    <label className="text-[10px] font-bold text-slate-400 uppercase mb-2 block">브랜드</label>
                                                    <select className="w-full p-3.5 bg-slate-50 border-0 rounded-2xl text-xs font-bold outline-none focus:ring-2 focus:ring-cyan-100" value={formData.airconBrand || 'LG'} onChange={(e) => setFormData(prev => ({...prev, airconBrand: e.target.value}))}><option value="LG">LG 전자 (휘센)</option><option value="삼성">삼성 전자 (무풍)</option></select>
                                                </div>
                                                <div>
                                                    <label className="text-[10px] font-bold text-slate-400 uppercase mb-2 block">설치 대수</label>
                                                    <input type="number" placeholder="0대" className="w-full p-3.5 bg-slate-50 border-0 rounded-2xl text-xs font-bold outline-none focus:ring-2 focus:ring-cyan-100 text-center" value={formData.airconCount} onChange={(e) => setFormData(prev => ({...prev, airconCount: e.target.value}))} />
                                                </div>
                                            </div>
                                        ) : (
                                            <div className="flex items-center justify-center p-10 bg-cyan-50/50 rounded-[2.5rem] border border-cyan-100 border-dashed">
                                                <p className="text-[11px] text-cyan-700 font-bold text-center leading-relaxed">배관 노출 및 매립 방식에 따라<br/>비용이 상이할 수 있습니다.</p>
                                            </div>
                                        )}
                                        <div>
                                            <label className="text-[10px] font-bold text-slate-400 uppercase mb-2 block">설치 위치 상세</label>
                                            <textarea className="w-full p-5 bg-slate-50 border-0 rounded-[2rem] h-32 outline-none text-xs font-medium focus:bg-white focus:ring-2 focus:ring-cyan-100 transition-all text-slate-600" placeholder="예: 거실1, 침실3..." value={formData.airconLocation} onChange={(e) => setFormData(prev => ({...prev, airconLocation: e.target.value}))} />
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section className="bg-white p-8 rounded-[3.5rem] shadow-sm border border-slate-100 section-break">
                                <SectionHeader title="주방 가구 사양" subTitle="Kitchen Specification" icon="utensils" colorClass="text-teal-600" />
                                <div className="space-y-6">
                                    {/* 주방 레이아웃 추가 */}
                                    <div className="bg-slate-50/50 p-6 rounded-[2.5rem] space-y-4">
                                        <p className="text-[10px] font-extrabold text-slate-400 uppercase tracking-widest px-1">주방 레이아웃</p>
                                        <div className="flex flex-wrap gap-2">
                                            {['일자형', 'ㄱ자형', 'ㄷ자형', '아일랜드', '대면형'].map(layout => (
                                                <button key={layout} onClick={() => toggleArrayItem('kitchenType', layout)} className={`px-4 py-2.5 rounded-xl text-[11px] font-bold border transition-all ${formData.kitchenType.includes(layout) ? 'bg-teal-600 border-teal-600 text-white shadow-md' : 'bg-white border-slate-100 text-slate-500 hover:border-teal-200'}`}>{layout}</button>
                                            ))}
                                        </div>
                                    </div>

                                    <div className="bg-slate-50/50 p-6 rounded-[2.5rem] space-y-4">
                                        <p className="text-[10px] font-extrabold text-slate-400 uppercase tracking-widest px-1">빌트인 가전 리스트</p>
                                        <div className="flex flex-wrap gap-2">
                                            {['키친핏 냉장고', '인덕션', '식기세척기', '오븐', '정수기', '커피장'].map(item => (
                                                <button key={item} onClick={() => toggleArrayItem('kitchenAppliances', item)} className={`px-4 py-2.5 rounded-xl text-[11px] font-bold border transition-all ${formData.kitchenAppliances.includes(item) ? 'bg-teal-500 border-teal-500 text-white shadow-md' : 'bg-white border-slate-100 text-slate-500 hover:border-teal-200'}`}>{item}</button>
                                            ))}
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="text-[10px] font-bold text-slate-400 uppercase mb-2 block">상판 소재</label>
                                            <select className="w-full p-3.5 bg-slate-50 border-0 rounded-2xl text-xs font-bold outline-none focus:ring-2 focus:ring-teal-100" value={formData.kitchenCountertop} onChange={(e) => setFormData(p => ({...p, kitchenCountertop: e.target.value}))}>
                                                <option value="인조대리석">인조대리석 (표준)</option><option value="엔지니어드스톤">엔지니어드스톤 (고급)</option><option value="세라믹">세라믹 (프리미엄)</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="text-[10px] font-bold text-slate-400 uppercase mb-2 block">하드웨어 등급</label>
                                            <select className="w-full p-3.5 bg-slate-50 border-0 rounded-2xl text-xs font-bold outline-none focus:ring-2 focus:ring-teal-100" value={formData.kitchenHardware} onChange={(e) => setFormData(p => ({...p, kitchenHardware: e.target.value}))}>
                                                <option value="표준">국산 표준 (국산)</option><option value="고급">Blum / 수입 하드웨어</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>

                        {/* 마감재 상세 섹션 */}
                        <section className="bg-white p-10 md:p-14 rounded-[4rem] shadow-xl shadow-slate-200/50 border border-slate-100 relative section-break">
                            <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-12 gap-10">
                                <SectionHeader title="공간별 마감재 선택" subTitle="Surface Finishing" icon="layers" colorClass="text-amber-500" />
                                
                                <div className="flex flex-wrap gap-2 bg-slate-100/50 p-2 rounded-[2rem] border border-slate-100 print:hidden overflow-x-auto no-scrollbar max-w-full">
                                    {SPACES.map(s => (
                                        <button key={s} type="button" onClick={() => setFormData(p => ({...p, activeFinishSpace: s}))}
                                            className={`px-6 py-2.5 rounded-[1.5rem] text-[11px] font-black transition-all whitespace-nowrap ${formData.activeFinishSpace === s ? 'bg-amber-500 text-white shadow-lg shadow-amber-100 scale-105' : 'text-slate-400 hover:text-slate-600 hover:bg-white'}`}>
                                            {s}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div className="relative p-10 bg-slate-50/50 rounded-[3.5rem] border border-slate-100">
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-8 relative z-10">
                                    <FinishItem 
                                        type="floor" title="바닥 (Floor)" icon="monitor" value={activeFinishes.floor}
                                        options={['미선택', '장판', '강마루', '원목마루', '타일', '도장']}
                                        detailValue={activeFinishes.floorOption}
                                        onMainChange={(val) => handleFinishChange('floor', val)}
                                        onDetailChange={(val) => handleFinishChange('floorOption', val)}
                                    />
                                    <FinishItem 
                                        type="wall" title="벽체 (Wall)" icon="columns" value={activeFinishes.wall}
                                        options={['미선택', '벽지', '도장', '필름', '디자인월']}
                                        detailValue={activeFinishes.wallpaperTypeWall}
                                        detailOptions={WALLPAPER_TYPES}
                                        onMainChange={(val) => handleFinishChange('wall', val)}
                                        onDetailChange={(val) => handleFinishChange('wallpaperTypeWall', val)}
                                    />
                                    <FinishItem 
                                        type="ceiling" title="천장 (Ceiling)" icon="maximize" value={activeFinishes.ceiling}
                                        options={['미선택', '벽지', '도장', '필름']}
                                        detailValue={activeFinishes.wallpaperTypeCeiling}
                                        detailOptions={WALLPAPER_TYPES}
                                        onMainChange={(val) => handleFinishChange('ceiling', val)}
                                        onDetailChange={(val) => handleFinishChange('wallpaperTypeCeiling', val)}
                                    />
                                </div>
                            </div>
                        </section>

                        {/* 욕실 섹션 */}
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-10">
                            {renderBathSection('publicBath', '공용 욕실 (Public)', 'indigo')}
                            {renderBathSection('masterBath', '부부 욕실 (Master)', 'purple')}
                        </div>

                        {/* 가구 및 수납 섹션 */}
                        <section className="bg-white p-10 md:p-14 rounded-[4rem] shadow-sm border border-slate-100 section-break">
                            <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-10 gap-8">
                                <SectionHeader title="가구 및 수납 계획" subTitle="Furniture & Storage" icon="box" colorClass="text-emerald-600" />
                                <div className="flex flex-wrap gap-1.5 print:hidden">
                                    {Object.keys(formData.furnitureBySpace).map(space => (
                                        <button key={space} type="button" onClick={() => setFormData(p => ({...p, activeSpace: space}))} className={`px-4 py-2 rounded-xl text-[11px] font-bold border transition-all ${formData.activeSpace === space ? 'bg-emerald-600 border-emerald-600 text-white shadow-md' : 'bg-slate-50 border-transparent text-slate-400 hover:border-emerald-200'}`}>
                                            {space}
                                        </button>
                                    ))}
                                </div>
                            </div>
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-12">
                                <div className="bg-emerald-50/30 p-10 rounded-[3.5rem] border border-emerald-100/50">
                                    <div className="flex items-center gap-4 mb-10">
                                        <div className="w-14 h-14 bg-emerald-500 rounded-3xl flex items-center justify-center text-white font-black text-xl shadow-lg shadow-emerald-100">{formData.activeSpace.slice(0,1)}</div>
                                        <div><p className="text-[11px] text-emerald-600 font-extrabold uppercase tracking-widest">Select Unit Items</p><p className="text-2xl font-black text-slate-800 tracking-tight">{formData.activeSpace} 빌트인 품목</p></div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        {['붙박이장', '화장대', '신발장', '팬트리', '키큰장', '진열장', '오픈장'].map(item => {
                                            const isActive = (formData.furnitureBySpace[formData.activeSpace] || []).includes(item);
                                            return (
                                                <label key={item} className={`flex items-center gap-4 p-5 rounded-2xl border-2 transition-all cursor-pointer ${isActive ? 'bg-white border-emerald-500 shadow-md' : 'bg-white/50 border-transparent text-slate-400 hover:border-emerald-100'}`}>
                                                    <div className={`w-5 h-5 rounded-md border-2 flex items-center justify-center transition-all ${isActive ? 'bg-emerald-500 border-emerald-500' : 'bg-transparent border-slate-200'}`}>
                                                        {isActive && <Icon name="check" size={12} className="text-white" />}
                                                    </div>
                                                    <input type="checkbox" className="hidden" checked={isActive} onChange={() => toggleFurnitureForSpace(item)} />
                                                    <span className={`text-sm font-bold ${isActive ? 'text-slate-900' : 'text-slate-400'}`}>{item}</span>
                                                </label>
                                            );
                                        })}
                                    </div>
                                </div>
                                <div className="flex flex-col gap-6">
                                    <div>
                                        <p className="text-[10px] font-extrabold text-slate-400 uppercase tracking-[0.2em] mb-4 px-1">가구 제작 및 시스템 상세</p>
                                        <textarea name="systemHangerInfo" value={formData.systemHangerInfo} onChange={handleInputChange} placeholder="시스템 행거 구성, 제작 가구 도어 사양, 내부 구성 등..." className="w-full p-8 bg-slate-50 border-0 rounded-[3rem] h-64 focus:bg-white focus:ring-4 focus:ring-emerald-50 outline-none text-sm font-medium transition-all" />
                                    </div>
                                    {/* 써머리 상시 노출 영역 */}
                                    <div className="summary-box">
                                        <p className="text-[11px] font-black text-emerald-600 uppercase tracking-widest mb-3 flex items-center gap-2 border-b border-emerald-100 pb-2">
                                            <Icon name="check-square" size={14} /> 가구 선택 요약 (Checklist Summary)
                                        </p>
                                        <div className="space-y-2">
                                            {Object.entries(formData.furnitureBySpace).map(([space, items]) => items.length > 0 && (
                                                <div key={space} className="flex gap-2 items-start text-[11px]">
                                                    <span className="font-bold text-emerald-700 min-w-[50px]">[{space}]</span> 
                                                    <span className="font-medium text-slate-600 leading-tight">{items.join(', ')}</span>
                                                </div>
                                            ))}
                                            {Object.values(formData.furnitureBySpace).every(arr => arr.length === 0) && (
                                                <p className="text-xs text-slate-400 italic">선택된 가구가 없습니다.</p>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        {/* 전기 및 목공 디테일 섹션 */}
                        <section className="bg-white p-10 md:p-14 rounded-[4rem] shadow-xl shadow-slate-200/50 border border-slate-100 section-break">
                            <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-10 gap-8">
                                <SectionHeader title="전기 및 목공 디테일" subTitle="Electrical & Carpentry" icon="zap" colorClass="text-rose-600" />
                                <div className="flex flex-wrap gap-1.5 print:hidden overflow-x-auto no-scrollbar max-w-full">
                                    {Object.keys(formData.detailsBySpace).map(space => (
                                        <button key={space} type="button" onClick={() => setFormData(p => ({...p, activeDetailSpace: space}))} className={`px-5 py-2.5 rounded-[1.2rem] text-[11px] font-black transition-all border ${formData.activeDetailSpace === space ? 'bg-rose-600 border-rose-600 text-white shadow-lg' : 'bg-slate-50 text-slate-400 hover:border-rose-200'}`}>
                                            {space}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-10">
                                <div className="bg-slate-50 p-8 rounded-[3rem] space-y-6">
                                    <h4 className="text-xs font-black text-slate-800 flex items-center gap-2 mb-4"><Icon name="lightbulb" size={16} className="text-orange-400"/> 조명 배치</h4>
                                    {['메인등', '매립등(다운)', '간접 조명', '라인 조명', '실링팬'].map(light => {
                                        const currentSpaceData = formData.detailsBySpace[formData.activeDetailSpace] || {};
                                        const isActive = (currentSpaceData.lighting || []).includes(light);
                                        return (
                                            <div key={light} className="space-y-2">
                                                <label className="flex items-center gap-3 cursor-pointer group">
                                                    <div className={`w-10 h-6 rounded-full relative transition-all ${isActive ? 'bg-orange-400' : 'bg-slate-200'}`}>
                                                        <div className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-all ${isActive ? 'left-5' : 'left-1'}`}></div>
                                                    </div>
                                                    <input type="checkbox" className="hidden" checked={isActive} onChange={() => toggleDetailForSpace('lighting', light)}/>
                                                    <span className={`text-[12px] font-extrabold ${isActive ? 'text-slate-900' : 'text-slate-400'}`}>{light}</span>
                                                </label>
                                                {isActive && <input type="text" placeholder="설치 위치 기입..." className="w-full p-2.5 text-[11px] bg-white border border-orange-100 rounded-xl outline-none font-bold" value={(currentSpaceData.lightingLocations || {})[light] || ''} onChange={(e) => handleDetailLocationChange(light, e.target.value)} />}
                                            </div>
                                        );
                                    })}
                                </div>

                                <div className="bg-slate-50 p-8 rounded-[3rem] space-y-6">
                                    <h4 className="text-xs font-black text-slate-800 flex items-center gap-2 mb-4"><Icon name="cpu" size={16} className="text-teal-500"/> 전기 & IoT</h4>
                                    <div className="grid grid-cols-1 gap-3">
                                        {['분전함 교체', '단독 배선', '일괄소등', 'IoT 시스템', '콘센트 증설'].map(item => {
                                            const isActive = (formData.detailsBySpace[formData.activeDetailSpace]?.electrical || []).includes(item);
                                            return (
                                                <button key={item} onClick={() => toggleDetailForSpace('electrical', item)} className={`p-4 rounded-[1.5rem] text-left border-2 transition-all ${isActive ? 'bg-teal-500 border-teal-500 text-white shadow-md' : 'bg-white border-transparent text-slate-400 hover:border-teal-100'}`}>
                                                    <span className="text-[11px] font-black">{item}</span>
                                                </button>
                                            );
                                        })}
                                    </div>
                                </div>

                                <div className="bg-slate-50 p-8 rounded-[3rem] space-y-6">
                                    <h4 className="text-xs font-black text-slate-800 flex items-center gap-2 mb-4"><Icon name="hammer" size={16} className="text-blue-400"/> 목공 디테일</h4>
                                    <div className="grid grid-cols-1 gap-3">
                                        {['천장 평탄화', '가벽 설치', '단열 공사', '문틀 보강', '커튼 박스', '웨인스코팅'].map(item => {
                                            const isActive = (formData.detailsBySpace[formData.activeDetailSpace]?.carpentry || []).includes(item);
                                            return (
                                                <button key={item} onClick={() => toggleDetailForSpace('carpentry', item)} className={`p-4 rounded-[1.5rem] text-left border-2 transition-all ${isActive ? 'bg-blue-500 border-blue-500 text-white shadow-md' : 'bg-white border-transparent text-slate-400 hover:border-blue-100'}`}>
                                                    <span className="text-[11px] font-black">{item}</span>
                                                </button>
                                            );
                                        })}
                                    </div>
                                </div>
                            </div>

                            {/* 전기/목공 써머리 상시 노출 영역 */}
                            <div className="summary-box mb-10 border-rose-100">
                                <p className="text-[11px] font-black text-rose-600 uppercase tracking-widest mb-4 flex items-center gap-2 border-b border-rose-100 pb-2">
                                    <Icon name="file-text" size={14} /> 전기 및 목공 상세 요약 (Technical Summary)
                                </p>
                                <div className="space-y-3">
                                    {Object.entries(formData.detailsBySpace).map(([space, data]) => (
                                        (data.lighting.length > 0 || data.electrical.length > 0 || data.carpentry.length > 0) && (
                                            <div key={space} className="grid grid-cols-1 md:grid-cols-4 gap-2 text-[11px] bg-white p-3 rounded-2xl border border-slate-100">
                                                <div className="font-bold text-rose-700">[{space}]</div>
                                                <div className="md:col-span-3 space-y-1">
                                                    {data.lighting.length > 0 && <div className="flex gap-2"><span className="text-orange-500 font-bold w-12 shrink-0">조명:</span> <span className="text-slate-600">{data.lighting.map(l => `${l}${data.lightingLocations[l] ? `(${data.lightingLocations[l]})` : ''}`).join(', ')}</span></div>}
                                                    {data.electrical.length > 0 && <div className="flex gap-2"><span className="text-teal-600 font-bold w-12 shrink-0">전기:</span> <span className="text-slate-600">{data.electrical.join(', ')}</span></div>}
                                                    {data.carpentry.length > 0 && <div className="flex gap-2"><span className="text-blue-600 font-bold w-12 shrink-0">목공:</span> <span className="text-slate-600">{data.carpentry.join(', ')}</span></div>}
                                                </div>
                                            </div>
                                        )
                                    ))}
                                    {Object.values(formData.detailsBySpace).every(d => d.lighting.length === 0 && d.electrical.length === 0 && d.carpentry.length === 0) && (
                                        <p className="text-xs text-slate-400 italic">기록된 상세 디테일이 없습니다.</p>
                                    )}
                                </div>
                            </div>

                            {/* 도어 및 몰딩 하단 통합 영역 */}
                            <div className="bg-slate-900 text-white p-10 rounded-[3.5rem] grid grid-cols-1 md:grid-cols-3 gap-10">
                                {(() => {
                                    const doorData = formData.doorDetailsBySpace[formData.activeDetailSpace] || {};
                                    return (
                                        <>
                                            <div className="space-y-6">
                                                <div className="flex items-center gap-3"><div className="p-2 bg-white/10 rounded-xl text-purple-300"><Icon name="box" size={18}/></div><p className="text-xs font-black text-purple-200">방문 및 문선</p></div>
                                                <div className="space-y-4">
                                                    <div><label className="text-[10px] font-bold text-slate-500 uppercase mb-2 block tracking-widest">도어 스타일</label>
                                                        <select className="w-full p-3.5 bg-white/5 border border-white/10 rounded-2xl text-xs font-bold outline-none text-white focus:bg-white/10" value={doorData.doorStyle || '미선택'} onChange={(e) => handleDoorDetailChange('doorStyle', e.target.value)}>
                                                            <option className="text-slate-900" value="미선택">미선택</option><option className="text-slate-900" value="일반문">일반문</option><option className="text-slate-900" value="9mm 문선">9mm 문선</option><option className="text-slate-900" value="히든 도어">히든 도어</option><option className="text-slate-900" value="무문선">무문선</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="space-y-6">
                                                <div className="flex items-center gap-3"><div className="p-2 bg-white/10 rounded-xl text-amber-300"><Icon name="scissors" size={18}/></div><p className="text-xs font-black text-amber-200">목공 마감</p></div>
                                                <div className="grid grid-cols-1 gap-4">
                                                    <div><label className="text-[10px] font-bold text-slate-500 uppercase mb-2 block tracking-widest">몰딩 선택</label>
                                                        <select className="w-full p-3.5 bg-white/5 border border-white/10 rounded-2xl text-xs font-bold outline-none text-white focus:bg-white/10" value={doorData.moldingType || '미선택'} onChange={(e) => handleDoorDetailChange('moldingType', e.target.value)}>
                                                            <option className="text-slate-900" value="미선택">미선택</option><option className="text-slate-900" value="무몰딩">무몰딩</option><option className="text-slate-900" value="마이너스몰딩">마이너스몰딩</option><option className="text-slate-900" value="일반몰딩">일반몰딩</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="space-y-6">
                                                <div className="flex items-center gap-3"><div className="p-2 bg-white/10 rounded-xl text-rose-300"><Icon name="layout" size={18}/></div><p className="text-xs font-black text-rose-200">현관 중문</p></div>
                                                <div><label className="text-[10px] font-bold text-slate-500 uppercase mb-2 block tracking-widest">중문 스타일</label>
                                                    <select className="w-full p-3.5 bg-white/5 border border-white/10 rounded-2xl text-xs font-bold outline-none text-white focus:bg-white/10" value={doorData.entranceDoor || '미선택'} onChange={(e) => handleDoorDetailChange('entranceDoor', e.target.value)}>
                                                        <option className="text-slate-900" value="미선택">미선택</option><option className="text-slate-900" value="초슬림 3연동">초슬림 3연동</option><option className="text-slate-900" value="원슬라이딩">원슬라이딩</option><option className="text-slate-900" value="비대칭 여닫이">비대칭 여닫이</option><option className="text-slate-900" value="스윙도어">스윙도어</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </>
                                    )
                                })()}
                            </div>
                        </section>

                        {/* 푸터 */}
                        <footer className="py-20 text-center space-y-4 border-t border-slate-200 mt-20 section-break">
                            <div className="flex justify-center items-center gap-4 mb-4">
                                <div className="w-8 h-8 bg-slate-900 rounded-full flex items-center justify-center text-white"><Icon name="home" size={14}/></div>
                                <p className="text-lg font-black tracking-[0.3em] uppercase text-slate-900">TOTODESIGN INTERIOR</p>
                            </div>
                            <p className="text-xs font-medium text-slate-400 leading-relaxed max-w-lg mx-auto">본 시트는 토토디자인의 상담 가이드용으로 제작되었습니다.<br/>상세 내역은 최종 확정된 도면 및 견적서를 기준으로 시공됩니다.</p>
                            <p className="text-[10px] font-bold text-slate-300 uppercase tracking-widest">© 2024 TOTODESIGN STUDIO. ALL RIGHTS RESERVED.</p>
                        </footer>
                    </div>

                    {/* 플로팅 버튼 (모바일 전용) */}
                    <button onClick={handlePrint} className="fixed bottom-8 right-8 bg-slate-900 text-white w-14 h-14 rounded-full shadow-2xl md:hidden hover:scale-110 active:scale-95 transition-all print:hidden z-50 flex items-center justify-center"><Icon name="save" size={24} /></button>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
